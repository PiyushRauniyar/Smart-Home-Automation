<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sensor Dashboard</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <div class="chart-container"><canvas id="ldrChart"></canvas></div>
    <div class="chart-container"><canvas id="mq5Chart"></canvas></div>
    <div class="chart-container"><canvas id="mq2Chart"></canvas></div>
    <div class="chart-container"><canvas id="soundChart"></canvas></div>
    <div class="chart-container"><canvas id="tempChart"></canvas></div>
    <div class="chart-container"><canvas id="humidityChart"></canvas></div>
    <div class="chart-container"><canvas id="pirChart"></canvas></div>
    <div class="chart-container"><canvas id="proximityChart"></canvas></div>

    <script>
        const socket = io();
        const chartDetails = [
            { id: 'ldrChart', label: 'LDR', borderColor: 'blue' },
            { id: 'mq5Chart', label: 'MQ5', borderColor: 'red' },
            { id: 'mq2Chart', label: 'MQ2', borderColor: 'green' },
            { id: 'soundChart', label: 'Sound', borderColor: 'purple' },
            { id: 'tempChart', label: 'Temperature', borderColor: 'orange' },
            { id: 'humidityChart', label: 'Humidity', borderColor: 'cyan' },
            { id: 'pirChart', label: 'PIR', borderColor: 'pink' },
            { id: 'proximityChart', label: 'Proximity', borderColor: 'yellow' },
        ];
        const charts = chartDetails.map(details => ({
            chart: new Chart(document.getElementById(details.id).getContext('2d'), {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{ label: details.label, data: [], borderColor: details.borderColor, fill: false }]
                },
                options: {
                    scales: {
                        y: { beginAtZero: true },
                        x: { display: true }
                    }
                }
            }),
            name: details.label
        }));
        socket.on('sensorData', function(data) {
            const [sensorName, value] = data.split(',');
            const timestamp = new Date().toLocaleTimeString();
            charts.forEach(chart => {
                if (chart.name === sensorName) {
                    updateChartData(chart.chart, timestamp, value);
                }
            });
        });
        function updateChartData(chart, label, value) {
            if (chart.data.labels.length > 20) {
                chart.data.labels.shift();
                chart.data.datasets[0].data.shift();
            }
            chart.data.labels.push(label);
            chart.data.datasets[0].data.push(value);
            chart.update();
        }
    </script>
</body>
</html>
